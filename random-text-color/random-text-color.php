<?php
/*
 * Plugin Name: Random Text Color ‚Äì ÈöèÊú∫ÂΩ©Ëâ≤ÊñáÂ≠ó
 * Plugin URI: https://github.com/2547729123/random-text-color
 * Description: ‰∏∫Âä†Á≤óÊñáÂ≠ó„ÄÅÊÆµËêΩ„ÄÅÂ∞èÊ†áÈ¢òÊ∑ªÂä†ÂΩ©Ëâ≤Ê†∑ÂºèÔºåÊîØÊåÅÊ∑±Ëâ≤Ê®°Âºè„ÄÅËá™ÂÆö‰πâÊ∏êÂèòÈÖçÁΩÆÔºåÊâÄÊúâÊ®°ÂùóÂèØÂçïÁã¨ÂºÄÂÖ≥ÊéßÂà∂„ÄÇ
 * Version: 1.0
 * Author: Á†ÅÈìÉËñØ
 * Author URI: https://www.tudoucode.cn
 * License: GPL2
 * License URI: https://www.gnu.org/licenses/gpl-2.0.html
 * Text Domain: random-text-color
 * Domain Path: /languages/
 * Requires at least: 5.0
 * Tested up to: 6.8
 * Requires PHP: 7.0
 *
 * ÂõΩÈôÖÂåñËØ¥ÊòéÔºö
 * Êú¨Êèí‰ª∂ÊîØÊåÅÂ§öËØ≠Ë®ÄÔºåËØ≠Ë®ÄÊñá‰ª∂Â≠òÊîæ‰∫é /languages/ ÁõÆÂΩï„ÄÇ
 * ËØ∑Á°Æ‰øùËØ≠Ë®ÄÂåÖÊñá‰ª∂ (.mo/.po) Â∑≤Ê≠£Á°ÆÊîæÁΩÆ„ÄÇ
 */

if ( ! defined( 'ABSPATH' ) ) exit;

// Âä†ËΩΩÊèí‰ª∂ËØ≠Ë®ÄÂåÖÔºåÊîØÊåÅÂõΩÈôÖÂåñÁøªËØë
function rbtc_load_textdomain() {
    load_plugin_textdomain(
        'random-text-color',
        false,
        dirname(plugin_basename(__FILE__)) . '/languages/'
    );
}
add_action('plugins_loaded', 'rbtc_load_textdomain');

// ÂêéÂè∞ËÆæÁΩÆÈ°µÈù¢
add_action('admin_menu', function() {
    add_options_page(__('Random Text Color ËÆæÁΩÆ', 'random-text-color'), __('ÊñáÂ≠óÈöèÊú∫Ëâ≤ËÆæÁΩÆ', 'random-text-color'), 'manage_options', 'rbtc-settings', 'rbtc_render_settings_page');
});

// Êï∞ÊçÆÂáÄÂåñÂõûË∞ÉÂáΩÊï∞ÂÆö‰πâ

// Checkbox ÂáÄÂåñÔºåËøîÂõû 1 Êàñ 0
function rbtc_sanitize_checkbox($input) {
    return $input === '1' ? 1 : 0;
}

// Ê∏êÂèòËâ≤Â≠óÁ¨¶‰∏≤ÂáÄÂåñÔºåÂÖÅËÆ∏‰ª•Ëã±ÊñáÈÄóÂè∑ÂàÜÈöîÁöÑ #RRGGBB Êàñ #RGB È¢úËâ≤ÔºåËøáÊª§ÈùûÊ≥ïÂÜÖÂÆπ
function rbtc_sanitize_gradient_colors($input) {
    $colors = explode(',', $input);
    $valid_colors = [];
    foreach ($colors as $color) {
        $color = trim($color);
        // ÁÆÄÂçïÂåπÈÖç #RGB Êàñ #RRGGBB Ê†ºÂºè
        if (preg_match('/^#([a-fA-F0-9]{3}|[a-fA-F0-9]{6})$/', $color)) {
            $valid_colors[] = strtoupper($color);
        }
    }
    // ÊúÄÂ∞ë‰∏Ä‰∏™ÊúâÊïàÈ¢úËâ≤ÔºåÊúÄÂ§ö10‰∏™
    if (count($valid_colors) === 0) {
        // ÈªòËÆ§Ê∏êÂèòËâ≤
        return '#FF0000,#FF9900,#33CC33';
    }
    return implode(',', array_slice($valid_colors, 0, 10));
}

// ÊúÄÂ§ßÊÆµËêΩÊï∞ÂáÄÂåñÔºåÁ°Æ‰øùÊòØ 1~20 ‰πãÈó¥ÁöÑÊï¥Êï∞
function rbtc_sanitize_max_paragraphs($input) {
    $num = intval($input);
    if ($num < 1) {
        $num = 1;
    } elseif ($num > 20) {
        $num = 20;
    }
    return $num;
}

// Ê≥®ÂÜåËÆæÁΩÆÈ°πÔºåÂπ∂ÁªëÂÆöÂØπÂ∫îÁöÑÂáÄÂåñÂõûË∞É
add_action('admin_init', function() {
    register_setting('rbtc_settings_group', 'rbtc_enable_plugin', ['sanitize_callback' => 'rbtc_sanitize_checkbox']);
    register_setting('rbtc_settings_group', 'rbtc_enable_bold_color', ['sanitize_callback' => 'rbtc_sanitize_checkbox']);
    register_setting('rbtc_settings_group', 'rbtc_enable_heading_gradient', ['sanitize_callback' => 'rbtc_sanitize_checkbox']);
    register_setting('rbtc_settings_group', 'rbtc_enable_paragraph_color', ['sanitize_callback' => 'rbtc_sanitize_checkbox']);
    register_setting('rbtc_settings_group', 'rbtc_enable_dark_mode_style', ['sanitize_callback' => 'rbtc_sanitize_checkbox']);
    register_setting('rbtc_settings_group', 'rbtc_custom_gradient_colors', ['sanitize_callback' => 'rbtc_sanitize_gradient_colors']);
    register_setting('rbtc_settings_group', 'rbtc_max_colored_paragraphs', ['sanitize_callback' => 'rbtc_sanitize_max_paragraphs']);
});

// Ê∏≤ÊüìËÆæÁΩÆÈ°µÈù¢
function rbtc_render_settings_page() {
    if (!current_user_can('manage_options')) {
        wp_die( esc_html__( '‰Ω†Êó†ÊùÉÈôêËÆøÈóÆËØ•È°µÈù¢„ÄÇ', 'random-text-color' ) );
    }
    ?>
    <style>
    /* Âü∫Á°ÄÊ†∑Âºè */
    .rbtc-wrap h1 {
        margin-bottom: 24px;
        color: #222;
        font-weight: 700;
    }
    .rbtc-wrap hr {
        margin: 40px 0;
        border: none;
        border-top: 1px solid #ddd;
    }
    .rbtc-wrap h2 {
        margin-top: 40px;
        margin-bottom: 16px;
        font-weight: 600;
        color: #333;
    }
    .rbtc-wrap p, .rbtc-wrap ul {
        font-size: 14px;
        color: #444;
        line-height: 1.6;
    }
    .rbtc-wrap ul {
        padding-left: 20px;
    }

    /* Pro ÂäüËÉΩÂç°ÁâáÂÆπÂô® */
    .rbtc-pro-cards {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        margin-top: 20px;
    }

    /* Âçï‰∏™Âç°Áâá */
    .rbtc-pro-card {
        flex: 1 1 280px;
        background: #fff;
        border-radius: 12px;
        box-shadow: 0 8px 20px rgba(34, 113, 177, 0.15);
        padding: 20px;
        color: #222;
        transition: box-shadow 0.3s ease;
        cursor: default;
    }
    .rbtc-pro-card:hover {
        box-shadow: 0 12px 30px rgba(34, 113, 177, 0.3);
    }
    .rbtc-pro-card h3 {
        margin-top: 0;
        margin-bottom: 12px;
        color: #2271b1;
        font-weight: 700;
        font-size: 18px;
    }
    .rbtc-pro-card p {
        font-size: 14px;
        color: #555;
    }
    .rbtc-pro-card .icon {
        font-size: 32px;
        margin-bottom: 12px;
        color: #2271b1;
    }

    /* ÊåâÈíÆ */
    .rbtc-pro-upgrade-btn {
        display: inline-block;
        margin-top: 24px;
        padding: 10px 28px;
        background: #2271b1;
        color: white;
        font-weight: 600;
        text-decoration: none;
        border-radius: 30px;
        box-shadow: 0 6px 12px rgba(34,113,177,0.4);
        transition: background 0.3s ease;
    }
    .rbtc-pro-upgrade-btn:hover {
        background: #135e96;
        box-shadow: 0 8px 18px rgba(19,94,150,0.6);
    }
    </style>

    <div class="wrap rbtc-wrap">
        <h1><?php esc_html_e('Random Text Color Êèí‰ª∂ËÆæÁΩÆ', 'random-text-color'); ?></h1>
        <form method="post" action="options.php">
            <?php settings_fields('rbtc_settings_group'); ?>
            <table class="form-table">
                <tr><th scope="row"><?php esc_html_e('ÂêØÁî®Êèí‰ª∂ÂäüËÉΩ', 'random-text-color'); ?></th><td><input type="checkbox" name="rbtc_enable_plugin" value="1" <?php checked(1, get_option('rbtc_enable_plugin', 0)); ?> /><?php esc_html_e('ÂêØÁî®Êèí‰ª∂Êï¥‰ΩìÂäüËÉΩ', 'random-text-color'); ?></td></tr>
                <tr><th scope="row"><?php esc_html_e('Âä†Á≤óÊñáÂ≠óÈöèÊú∫È¢úËâ≤', 'random-text-color'); ?></th><td><input type="checkbox" name="rbtc_enable_bold_color" value="1" <?php checked(1, get_option('rbtc_enable_bold_color', 0)); ?> /> <?php esc_html_e('ÂêØÁî®', 'random-text-color'); ?></td></tr>
                <tr><th scope="row"><?php esc_html_e('Â∞èÊ†áÈ¢òÂΩ©ËôπÊ∏êÂèò', 'random-text-color'); ?></th><td><input type="checkbox" name="rbtc_enable_heading_gradient" value="1" <?php checked(1, get_option('rbtc_enable_heading_gradient', 0)); ?> /> <?php esc_html_e('ÂêØÁî®', 'random-text-color'); ?></td></tr>
                <tr><th scope="row"><?php esc_html_e('ÊÆµËêΩÈöèÊú∫È¢úËâ≤', 'random-text-color'); ?></th><td><input type="checkbox" name="rbtc_enable_paragraph_color" value="1" <?php checked(1, get_option('rbtc_enable_paragraph_color', 0)); ?> /> <?php esc_html_e('ÂêØÁî®', 'random-text-color'); ?></td></tr>
                <tr><th scope="row"><?php esc_html_e('ÂêØÁî®ÊöóÈªëÊ®°ÂºèÈÖçËâ≤', 'random-text-color'); ?></th><td><input type="checkbox" name="rbtc_enable_dark_mode_style" value="1" <?php checked(1, get_option('rbtc_enable_dark_mode_style', 0)); ?> /> <?php esc_html_e('ÂêØÁî®', 'random-text-color'); ?></td></tr>
                <tr><th scope="row"><?php esc_html_e('Ëá™ÂÆö‰πâÊ∏êÂèòËâ≤ÔºàËã±ÊñáÈÄóÂè∑ÂàÜÈöîÔºâ', 'random-text-color'); ?></th>
                    <td><input type="text" name="rbtc_custom_gradient_colors" value="<?php echo esc_attr(get_option('rbtc_custom_gradient_colors', '#FF0000,#FF9900,#33CC33')); ?>" size="70" /></td>
                </tr>
                <tr><th scope="row"><?php esc_html_e('ÊúÄÂ§öÁùÄËâ≤ÊÆµËêΩÊï∞', 'random-text-color'); ?></th>
                    <td><input type="number" name="rbtc_max_colored_paragraphs" value="<?php echo esc_attr(get_option('rbtc_max_colored_paragraphs', 5)); ?>" min="1" max="20" /></td>
                </tr>
            </table>
            <?php submit_button(); ?>
        </form>

        <hr>

        <h2><?php esc_html_e('ÂºÄÂèëËÄÖ‰ø°ÊÅØ', 'random-text-color'); ?></h2>
        <?php /* translators: %s ÊòØÂÆòÁΩëÈìæÊé• */ ?>
		<p><?php printf(wp_kses(__('Êèí‰ª∂Áî± <a href="%s" target="_blank" rel="noopener">Á†ÅÈìÉËñØ</a> ÂºÄÂèëÁª¥Êä§ÔºåÊ¨¢ËøéËÆøÈóÆÂÆòÁΩëËé∑ÂèñÊõ¥Â§öÊîØÊåÅ„ÄÇ', 'random-text-color'), ['a' => ['href' => [], 'target' => [], 'rel' => []]]), esc_url('https://www.tudoucode.cn/')); ?></p>
        <h2><?php esc_html_e('‰ΩøÁî®Ê≥®ÊÑè‰∫ãÈ°π', 'random-text-color'); ?></h2>
        <ul>
            <li><?php esc_html_e('ÂêØÁî®Êèí‰ª∂ÂêéËØ∑Ê∏ÖÁêÜÁºìÂ≠òÔºåÁ°Æ‰øùÊïàÊûúÁîüÊïà„ÄÇ', 'random-text-color'); ?></li>
            <li><?php esc_html_e('Ê∑±Ëâ≤Ê®°ÂºèÂÖºÂÆπÈúÄÂºÄÂêØÂØπÂ∫îÈÄâÈ°π„ÄÇ', 'random-text-color'); ?></li>
            <li><?php esc_html_e('Â¶ÇÈÅáÈóÆÈ¢òÔºåËØ∑ÂÖàÊü•ÁúãÂ∏∏ËßÅÈóÆÈ¢òÊàñËÅîÁ≥ªÊàë‰ª¨„ÄÇ', 'random-text-color'); ?></li>
        </ul>

        <h2><?php esc_html_e('ÂçáÁ∫ßÂà∞ Pro ÁâàÊú¨Ôºå‰∫´ÂèóÊõ¥Â§öÈ´òÁ∫ßÂäüËÉΩ', 'random-text-color'); ?></h2>
        <div class="rbtc-pro-cards">
            <div class="rbtc-pro-card">
                <div class="icon">üåà</div>
                <h3><?php esc_html_e('Â§öÂΩ©È´òÁ∫ßÊ∏êÂèò', 'random-text-color'); ?></h3>
                <p><?php esc_html_e('ÊîØÊåÅÊó†ÈôêËá™ÂÆö‰πâÊ∏êÂèòËâ≤ÔºåÊâìÈÄ†Áã¨‰∏ÄÊó†‰∫åÁöÑÂΩ©ËôπÊñáÂ≠óÊïàÊûú„ÄÇ', 'random-text-color'); ?></p>
            </div>
            <div class="rbtc-pro-card">
                <div class="icon">‚ö°</div>
                <h3><?php esc_html_e('Ëá™Âä®È¢úËâ≤‰ºòÂåñ', 'random-text-color'); ?></h3>
                <p><?php esc_html_e('Êô∫ËÉΩË∞ÉÊï¥ÊñáÂ≠óÈ¢úËâ≤ÔºåÁ°Æ‰øùÂú®ÂêÑÁßçËÉåÊôØ‰∏ãÈÉΩÊ∏ÖÊô∞ÂèØËßÅ„ÄÇ', 'random-text-color'); ?></p>
            </div>
            <div class="rbtc-pro-card">
                <div class="icon">üîß</div>
                <h3><?php esc_html_e('‰∏ì‰∏öÂÆ¢Êà∑ÊîØÊåÅ', 'random-text-color'); ?></h3>
                <p><?php esc_html_e('‰ºòÂÖàÂìçÂ∫î‰Ω†ÁöÑÈóÆÈ¢òÂíåÈúÄÊ±ÇÔºå‰∏ìÂ±ûÊúçÂä°Êõ¥È´òÊïà„ÄÇ', 'random-text-color'); ?></p>
            </div>
            <div class="rbtc-pro-card">
                <div class="icon">üöÄ</div>
                <h3><?php esc_html_e('Ëá™Âä®Êõ¥Êñ∞', 'random-text-color'); ?></h3>
                <p><?php esc_html_e('Pro ÁâàÊú¨Ëá™Âä®Êé®ÈÄÅÊúÄÊñ∞ÂäüËÉΩÂíåÂÆâÂÖ®Ë°•‰∏ÅÔºåÊó†ÈúÄÊâãÂä®Êìç‰Ωú„ÄÇ', 'random-text-color'); ?></p>
            </div>
        </div>
        <a href="https://www.tudoucode.cn/" target="_blank" class="rbtc-pro-upgrade-btn"><?php esc_html_e('Á´ãÂç≥ÂçáÁ∫ß Pro ÁâàÊú¨', 'random-text-color'); ?></a>
    </div>
    <?php
}

// Êèí‰ª∂ÂâçÁ´ØËæìÂá∫ÈÄªËæëÔºöÂú®È°µÈù¢Â∫ïÈÉ®ÊèíÂÖ•Ê†∑ÂºèÂíåËÑöÊú¨
add_action('wp_footer', function() {
    // Âè™Âú®ÂçïÁØáÊñáÁ´†È°µÂêØÁî®Ôºå‰∏î AMP È°µÈù¢‰∏çÊâßË°å
    if (!is_single() || (function_exists('is_amp_endpoint') && is_amp_endpoint())) return;

    // Â¶ÇÊûúÊèí‰ª∂Êú™ÂêØÁî®Âàô‰∏çËæìÂá∫‰ªª‰ΩïÂÜÖÂÆπ
    if (!get_option('rbtc_enable_plugin')) return;

    // Ëé∑ÂèñÊèí‰ª∂ËÆæÁΩÆÈ°π
    $enable_bold = get_option('rbtc_enable_bold_color'); // ÊòØÂê¶ÂêØÁî®Á≤ó‰ΩìÂèòËâ≤
    $enable_headings = get_option('rbtc_enable_heading_gradient'); // ÊòØÂê¶ÂêØÁî®Ê†áÈ¢òÊ∏êÂèòËâ≤
    $enable_para = get_option('rbtc_enable_paragraph_color'); // ÊòØÂê¶ÂêØÁî®ÊÆµËêΩÊñáÂ≠óÈöèÊú∫Ëâ≤
    $enable_dark = get_option('rbtc_enable_dark_mode_style'); // ÊòØÂê¶ÂêØÁî®ÊöóËâ≤Ê®°Âºè‰ºòÂåñÊ†∑Âºè

    // Ëé∑ÂèñËá™ÂÆö‰πâÊ∏êÂèòÈ¢úËâ≤ËÆæÁΩÆÔºåÈªòËÆ§Êèê‰æõ‰∏â‰∏™Âü∫Á°ÄÈ¢úËâ≤
    $custom_colors = get_option('rbtc_custom_gradient_colors', '#FF0000,#FF9900,#33CC33');

    // ÂàÜËß£È¢úËâ≤‰∏∫Êï∞ÁªÑÔºåÂπ∂ÈôêÂà∂ÊúÄÂ§ßÈ¢úËâ≤Êï∞Èáè‰∏∫10‰∏™
    $gradient_array = explode(',', $custom_colors);
    $gradient_array = array_map('trim', $gradient_array);
    $gradient_array = array_filter($gradient_array, function($color) {
        return preg_match('/^#([a-fA-F0-9]{3}|[a-fA-F0-9]{6})$/', $color);
    });
    $gradient_array = array_slice($gradient_array, 0, 10);

    // ËΩ¨‰∏∫ JS Ê†ºÂºèÁöÑÈ¢úËâ≤Â≠óÁ¨¶‰∏≤Êï∞ÁªÑ
    $gradient_colors_js = json_encode(array_values($gradient_array));

    // ËÆæÁΩÆÊúÄÂ§ßÁùÄËâ≤ÊÆµËêΩÊï∞ÔºàÈªòËÆ§ÊúÄÂ§öÂ§ÑÁêÜ 5 ‰∏™ÊÆµËêΩÔºâ
    $max_para = intval(get_option('rbtc_max_colored_paragraphs', 5));
    if ($max_para < 1) $max_para = 1;
    if ($max_para > 20) $max_para = 20;

    // ËæìÂá∫Ê†∑Âºè‰ª£Á†ÅÔºàÂåÖÊã¨ÊöóÈªëÊ®°ÂºèÂÖºÂÆπ + Ê†áÈ¢òÊ∏êÂèòÊ†∑ÂºèÔºâ
    echo "<style>";
    if ($enable_dark) {
        // ÊöóÈªëÊ®°Âºè‰∏ãÁöÑÂÖºÂÆπÊ†∑Âºè
        echo "@media (prefers-color-scheme: dark) {
            .entry-content, .post-content, .article-content, article { color: #e0e0e0 !important; }
            .rainbow-gradient-text { color: transparent !important; }
            p { color: #d0d0d0 !important; }
            strong, b { color: #ffcc00 !important; }
        }";
    }

    // Ê∏êÂèòÊñáÂ≠óÂü∫Á°ÄÊ†∑ÂºèÂÆö‰πâ
    echo ".rainbow-gradient-text {
        background-clip: text; -webkit-background-clip: text;
        -webkit-text-fill-color: transparent; text-fill-color: transparent;
        font-weight: bold; display: inline;
    }</style>";
    ?>

    <script>
    document.addEventListener('DOMContentLoaded', function () {
        const content = document.querySelector('.entry-content, .post-content, .article-content, article');
        if (!content) return;

        const isDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;

        // Ëé∑ÂèñÊâÄÊúâÁ≤ó‰ΩìÊñáÂ≠ó„ÄÅÊ†áÈ¢òÂíåÊÆµËêΩ
        const bolds = content.querySelectorAll('strong, b');
        const headings = content.querySelectorAll('h2, h3, h4, h5, h6');
        const paras = content.querySelectorAll('p');

        // Ê∏êÂèòÈ¢úËâ≤Êï∞ÁªÑ
		const gradientColors = <?php echo wp_json_encode($gradient_array); ?>;



        // Ëé∑ÂèñÈöèÊú∫È¢úËâ≤ÂáΩÊï∞ÔºåÈÅøÂÖçËøá‰∫ÆÊàñËøáÊöó
        function getRandomColor() {
            function rand(min = 0, max = 255) {
                return Math.floor(Math.random() * (max - min + 1)) + min;
            }
            let r, g, b, bright;
            do {
                r = rand(); g = rand(); b = rand();
                bright = r + g + b;
                if (!isDarkMode && bright > 600) continue; // ÊôÆÈÄöÊ®°Âºè‰∏çÂ§™‰∫Æ
                if (isDarkMode && bright < 200) continue; // ÊöóÊ®°Âºè‰∏çÂ§™Êöó
                break;
            } while (true);
            return `rgb(${r},${g},${b})`;
        }

        // === Ê∏≤ÊüìÁ≤ó‰ΩìÊñáÂ≠ó ===
        <?php if ($enable_bold): ?>
        bolds.forEach(el => {
            el.style.color = getRandomColor();
        });
        <?php endif; ?>

        // === Ê∏≤ÊüìÊ†áÈ¢ò‰∏∫Ê∏êÂèòËâ≤ ===
        <?php if ($enable_headings): ?>
        headings.forEach((el, i) => {
            // ‰ΩøÁî®ÂΩìÂâçÁ¥¢ÂºïÂíå‰∏ã‰∏Ä‰∏™È¢úËâ≤ÊãºÊé•Ê∏êÂèò
            const c1 = gradientColors[i % gradientColors.length];
            const c2 = gradientColors[(i + 1) % gradientColors.length];
            el.style.backgroundImage = `linear-gradient(to right, ${c1}, ${c2})`;
            el.style.backgroundSize = '100% 100%';
            el.classList.add('rainbow-gradient-text');
        });
        <?php endif; ?>

        // === Ê∏≤ÊüìÊÆµËêΩ‰∏∫ÈöèÊú∫È¢úËâ≤ÔºàÊúÄÂ§öÂ§ÑÁêÜ N ‰∏™ÊÆµËêΩÔºâ===
        <?php if ($enable_para): ?>
        let count = 0;
        let paraArray = Array.from(paras);

        // Ê¥óÁâåÈöèÊú∫È°∫Â∫èÔºåÈÅøÂÖçÊÄªÊòØÂâçÈù¢Âá†ÊÆµÁùÄËâ≤
        for (let i = paraArray.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [paraArray[i], paraArray[j]] = [paraArray[j], paraArray[i]];
        }

		paraArray.forEach(p => {
            if (count >= <?php echo wp_json_encode(intval($max_para)); ?>) return;
            if (p.querySelector('strong, b')) return; // ÊúâÁ≤ó‰ΩìË∑≥ËøáÔºåÈÅøÂÖçÂÜ≤Á™Å

            p.style.color = getRandomColor();
            count++;
        });
        <?php endif; ?>
    });
    </script>

    <?php
});

// Êèí‰ª∂ÂàóË°®È°µÁöÑËÆæÁΩÆÂíåÂçáÁ∫ßÈìæÊé•
add_filter('plugin_action_links_' . plugin_basename(__FILE__), function($links) {
    $settings_url = esc_url(admin_url('options-general.php?page=rbtc-settings'));
    $settings_link = '<a href="' . $settings_url . '">' . esc_html__('ËÆæÁΩÆ', 'random-text-color') . '</a>';
    $pro_url = esc_url('https://www.tudoucode.cn/');
    $pro_link = '<a href="' . $pro_url . '" target="_blank" style="color:#d54e21;">' . esc_html__('ProÁâà', 'random-text-color') . '</a>';
    array_unshift($links, $settings_link);
    $links[] = $pro_link;
    return $links;
});
